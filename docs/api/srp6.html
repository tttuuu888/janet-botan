



<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="../mdzdoc-css/main.css" type="text/css" charset="utf-8">
    <title>SRP6 Server Session</title>
    <meta name="description" content="">
  </head>
  <body>
    <!-- Toggles Navigation -->
    <div id="toc-toggle" class="">
      <div class="bar topbar"></div>
      <div class="bar"></div>
      <div class="bar botbar"></div>
    </div>
    <div class="twocol">
      <div class="toc toc-hidden">
        <ul>
          <li><span><a href="../index.html">Janet-botan</a></span></li><li class="caret"><span><a href="index.html">API</a></span><ul><li><span><a href="versioning.html">Versioning</a></span></li><li><span><a href="utiltity.html">Utility</a></span></li><li><span><a href="rng.html">Random Number Generators</a></span></li><li><span><a href="block_cipher.html">Block Ciphers</a></span></li><li><span><a href="hash.html">Hash Functions</a></span></li><li><span><a href="mac.html">Message Authentication Codes</a></span></li><li><span><a href="cipher.html">Symmetric Ciphers</a></span></li><li><span><a href="pbkdf.html">PBKDF</a></span></li><li><span><a href="kdf.html">KDF</a></span></li><li><span><a href="mpi.html">Multiple Precision Integers</a></span></li><li><span><a href="bcrypt.html">Bcrypt</a></span></li><li><span><a href="private_key.html">Private Key</a></span></li><li><span><a href="public_key.html">Public Key</a></span></li><li><span><a href="pk_operations.html">Public Key Operations</a></span></li><li><span><a href="x509_cert.html">X509 Certificate</a></span></li><li><span><a href="x509_crl.html">X509 CRL</a></span></li><li><span><a href="nist_key_wrapping.html">NIST Key Wrapping</a></span></li><li><span><a href="script.html">Scrypt</a></span></li><li><span><a href="hotp.html">HOTP</a></span></li><li><span><a href="totp.html">TOTP</a></span></li><li><span><a href="fpe.html">Format Preserving Encryption</a></span></li><li><span class="selected"><a href="srp6.html">SRP6 Server Session</a></span></li><li><span><a href="zfec.html">ZFEC Forward Error Correction</a></span></li></ul></li>
        </ul>
      </div>
      <div class="content-wrapper">
        <h1>SRP6 Server Session</h1>
        <div class="prevnext-bar">
          <span class="prev"><a href="fpe.html"><span class="prevnext-text">Format Preserving Encryption</span></a></span>
          <span class="next"><a href="zfec.html"><span class="prevnext-text">ZFEC Forward Error Correction</span></a></span>
        </div>
        

<h2 id="Index-16">Index
</h2>
<p><a href="#srp6-server-session/new">srp6-server-session/new</a><span class="divider"> </span><a href="#srp6-server-session/step1">srp6-server-session/step1</a><span class="divider"> </span><a href="#srp6-server-session/step2">srp6-server-session/step2</a></p><p><a href="#srp6-generate-verifier">srp6-generate-verifier</a></p><p><a href="#srp6-client-agree">srp6-client-agree</a></p><h2 id="Reference-16">Reference
</h2>
<div class="docstring"><div class="binding-wrap"><span class="binding"><a id="srp6-server-session/new">srp6-server-session/new</a></span><span class="binding-type">cfunction</span></div><pre class="mendoza-codeblock"><code data-language="janet">(<span class="mdzsyn-symbol">srp6-server-session/new</span> <span class="mdzsyn-symbol">group-id</span>)</code></pre><p>Create srp6 server session object along with `group-id`.</p></div><div class="docstring"><div class="binding-wrap"><span class="binding"><a id="srp6-server-session/step1">srp6-server-session/step1</a></span><span class="binding-type">cfunction</span></div><pre class="mendoza-codeblock"><code data-language="janet">(<span class="mdzsyn-symbol">srp6-server-session/step1</span> <span class="mdzsyn-symbol">srp6-obj</span> <span class="mdzsyn-symbol">verifier</span> <span class="mdzsyn-coresym">hash</span> <span class="mdzsyn-symbol">rng</span>)</code></pre><p>Takes a verifier (generated by srp6-generate-verifier) along with the group-id, and output a value B which is provided to the client.</p></div><div class="docstring"><div class="binding-wrap"><span class="binding"><a id="srp6-server-session/step2">srp6-server-session/step2</a></span><span class="binding-type">cfunction</span></div><pre class="mendoza-codeblock"><code data-language="janet">(<span class="mdzsyn-symbol">srp6-server-session/step2</span> <span class="mdzsyn-symbol">srp6-obj</span> <span class="mdzsyn-symbol">A</span>)</code></pre><p>Takes the parameter A generated by srp6-client-agree, and return the shared secret key.<br>In the event of an impersonation attack (or wrong username/password, etc) no error occurs, but the key returned will be different on the two sides. The two sides must verify each other, for example by using the shared secret to key an HMAC and then exchanging authenticated messages.</p></div><div class="docstring"><div class="binding-wrap"><span class="binding"><a id="srp6-generate-verifier">srp6-generate-verifier</a></span><span class="binding-type">cfunction</span></div><pre class="mendoza-codeblock"><code data-language="janet">(<span class="mdzsyn-symbol">srp6-generate-verifier</span> <span class="mdzsyn-symbol">identifier</span> <span class="mdzsyn-symbol">password</span> <span class="mdzsyn-symbol">salt</span> <span class="mdzsyn-symbol">group-id</span> <span class="mdzsyn-coresym">hash</span>)</code></pre><p>Generates a new verifier using the specified `password` and `salt`. This is stored by the server. The salt must also be stored. Later, the given username(`identifier`) and `password` are used to by the client during the key agreement step.</p></div><div class="docstring"><div class="binding-wrap"><span class="binding"><a id="srp6-client-agree">srp6-client-agree</a></span><span class="binding-type">cfunction</span></div><pre class="mendoza-codeblock"><code data-language="janet">(<span class="mdzsyn-symbol">srp6-client-agree</span> <span class="mdzsyn-symbol">username</span> <span class="mdzsyn-symbol">password</span> <span class="mdzsyn-symbol">group-id</span> <span class="mdzsyn-coresym">hash</span> <span class="mdzsyn-symbol">salt</span> <span class="mdzsyn-symbol">B</span> <span class="mdzsyn-symbol">&amp;opt</span> <span class="mdzsyn-symbol">rng</span>)</code></pre><p>The client receives these parameters from the server, except for the `username` and `password` which are provided by the user. The parameter B is the output of step1.<br>The client agreement step outputs a shared symmetric key along with the parameter A which is returned to the server (and allows it the compute the shared key).</p></div>
        <div class="prevnext-bar">
          <span class="prev"><a href="fpe.html"><span class="prevnext-text">Format Preserving Encryption</span></a></span>
          <span class="next"><a href="zfec.html"><span class="prevnext-text">ZFEC Forward Error Correction</span></a></span>
        </div>
      </div>
    </div>
    <script charset="utf-8">
      function toggleToc() {
        var toggler = document.getElementById('toc-toggle');
        var wrapper = document.querySelector('.toc');
        wrapper.classList.toggle('toc-hidden');
        toggler.classList.toggle('open');
        window.localStorage.setItem('show-toc', toggler.classList.contains('open'));
      }
      function addTocToggle() {
        var el = document.getElementById('toc-toggle');
        el.addEventListener('click', toggleToc);
      }
      window.addEventListener('DOMContentLoaded', addTocToggle);
      if (window.localStorage.getItem('show-toc') === 'true') {
        toggleToc()
      }
    </script>
    <footer>
      <div class="content-wrapper">
        Copyright &copy; Seungki Kim 2024
      </div>
    </footer>
  </body>
</html>
