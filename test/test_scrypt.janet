(use ../build/botan)
(use spork/test)

(start-suite "scrypt")

(assert (= (hex-encode (scrypt 64 "" "" 16 1 1))
           "77D6576238657B203B19CA42C18A0497F16B4844E3074AE8DFDFFA3FEDE21442FCD0069DED0948F8326A753A0FC81F17E8D3E0FB2E0D3628CF35E20C38D18906"))

(assert (= (hex-encode (scrypt 64 "password" "NaCl" 1024 8 16))
           "FDBABE1C9D3472007856E7190D01E9FE7C6AD7CBC8237830E77376634B3731622EAF30D92E22A3886FF109279D9830DAC727AFB94A83EE6D8360CBDFA2CC0640"))

(assert (= (hex-encode (scrypt 64 "pleaseletmein" "SodiumChloride" 16384 8 1))
           "7023BDCB3AFD7348461C06CD81FD38EBFDA8FBBA904F8E3EA9B543F6545DA1F2D5432955613F0FCF62D49705242A9AF9E61E85DC0D651E40DFCF017B45575887"))

(end-suite)
